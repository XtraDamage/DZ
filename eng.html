<!DOCTYPE html>
<html lang="ru" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>English Grammar | Решение Упр. 12</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&family=Roboto:wght@400;500&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <!-- Material Symbols -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,1,0" />

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Google Sans', 'Roboto', 'sans-serif'],
                        mono: ['Roboto Mono', 'monospace'],
                    },
                    borderRadius: {
                        '4xl': '32px',
                        '5xl': '40px',
                    },
                    colors: {
                        light: {
                            bg: '#F0F4F8',
                            surface: '#FFFFFF',
                            surfaceContainer: 'rgb(var(--color-surface-container) / <alpha-value>)',
                            surfaceContainerHigh: 'rgb(var(--color-surface-container-high) / <alpha-value>)',
                            primary: 'rgb(var(--color-primary) / <alpha-value>)',
                            onPrimary: 'rgb(var(--color-on-primary) / <alpha-value>)',
                            secondaryContainer: 'rgb(var(--color-secondary-container) / <alpha-value>)',
                            onSecondaryContainer: 'rgb(var(--color-on-secondary-container) / <alpha-value>)',
                            tertiaryContainer: 'rgb(var(--color-tertiary-container) / <alpha-value>)',
                            onTertiaryContainer: 'rgb(var(--color-on-tertiary-container) / <alpha-value>)',
                            correct: '#E8F5E9',
                            onCorrect: '#1B5E20',
                            error: '#FFEBEE',
                            onError: '#B71C1C',
                        },
                        dark: {
                            bg: '#0B1015',
                            surface: '#10151A',
                            surfaceContainer: '#182026',
                            surfaceContainerHigh: '#202830',
                            primary: 'rgb(var(--color-primary) / <alpha-value>)',
                            onPrimary: 'rgb(var(--color-on-primary) / <alpha-value>)',
                            secondaryContainer: 'rgb(var(--color-secondary-container) / <alpha-value>)',
                            onSecondaryContainer: 'rgb(var(--color-on-secondary-container) / <alpha-value>)',
                            tertiaryContainer: 'rgb(var(--color-tertiary-container) / <alpha-value>)',
                            onTertiaryContainer: 'rgb(var(--color-on-tertiary-container) / <alpha-value>)',
                            correct: '#1E3226',
                            onCorrect: '#A5D6A7',
                            error: '#410E0B',
                            onError: '#F2B8B5',
                        }
                    },
                    animation: {
                        'enter': 'enter 0.6s cubic-bezier(0.2, 0.0, 0, 1.0) forwards',
                    },
                    keyframes: {
                        enter: {
                            '0%': { opacity: 0, transform: 'translateY(20px)' },
                            '100%': { opacity: 1, transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body { 
            -webkit-tap-highlight-color: transparent; 
            overscroll-behavior-y: none;
            transition: background-color 0.5s ease;
        }
        .eng-font { 
            font-family: 'Roboto', sans-serif; 
            letter-spacing: 0.01em;
        }
        /* Custom scrollbar hide */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="bg-light-bg dark:bg-dark-bg text-[#1D1B20] dark:text-[#E6E0E9] transition-colors duration-500 min-h-screen selection:bg-light-primary selection:text-white">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        /* --- Theme Logic --- */
        const hslToRgb = (h, s, l) => {
            s /= 100;
            l /= 100;
            const k = n => (n + h / 30) % 12;
            const a = s * Math.min(l, 1 - l);
            const f = n =>
                l - a * Math.max(-1, Math.min(k(n) - 3, Math.min(9 - k(n), 1)));
            const r = Math.round(255 * f(0));
            const g = Math.round(255 * f(8));
            const b = Math.round(255 * f(4));
            return `${r} ${g} ${b}`;
        };

        const updateThemeVariables = (primaryHue, tertiaryHue, isDark) => {
            const root = document.documentElement;
            if (!isDark) {
                root.style.setProperty('--color-primary', hslToRgb(primaryHue, 60, 40)); 
                root.style.setProperty('--color-on-primary', '255 255 255');
                root.style.setProperty('--color-surface-container', hslToRgb(primaryHue, 20, 96));
                root.style.setProperty('--color-surface-container-high', hslToRgb(primaryHue, 25, 92));
                root.style.setProperty('--color-secondary-container', hslToRgb(primaryHue, 30, 90));
                root.style.setProperty('--color-on-secondary-container', '#1D192B');
                root.style.setProperty('--color-tertiary-container', hslToRgb(tertiaryHue, 40, 90));
                root.style.setProperty('--color-on-tertiary-container', hslToRgb(tertiaryHue, 60, 20));
            } else {
                root.style.setProperty('--color-primary', hslToRgb(primaryHue, 70, 80)); 
                root.style.setProperty('--color-on-primary', hslToRgb(primaryHue, 70, 20));
                root.style.setProperty('--color-surface-container', '#182026'); 
                root.style.setProperty('--color-surface-container-high', '#202830');
                root.style.setProperty('--color-secondary-container', hslToRgb(primaryHue, 20, 30));
                root.style.setProperty('--color-on-secondary-container', hslToRgb(primaryHue, 70, 90));
                root.style.setProperty('--color-tertiary-container', hslToRgb(tertiaryHue, 40, 30));
                root.style.setProperty('--color-on-tertiary-container', hslToRgb(tertiaryHue, 70, 90));
            }
        };

        /* --- Icons & Visuals --- */
        const Icon = ({ name, className = "" }) => (
            <span className={`material-symbols-rounded select-none ${className}`}>{name}</span>
        );

        const TimelineVisual = ({ type }) => (
            <svg viewBox="0 0 100 60" className="w-16 h-10 opacity-80 text-light-primary dark:text-dark-primary stroke-current">
                <line x1="10" y1="30" x2="90" y2="30" strokeWidth="2" />
                <line x1="85" y1="25" x2="90" y2="30" strokeWidth="2" />
                <line x1="85" y1="35" x2="90" y2="30" strokeWidth="2" />
                
                {type === 'simple' && <circle cx="50" cy="30" r="4" fill="currentColor" stroke="none"/>}
                {type === 'continuous' && <path d="M 30 30 Q 40 10 50 30 T 70 30" fill="none" strokeWidth="2" strokeDasharray="2 2" />}
                {type === 'perfect' && (
                    <>
                         <circle cx="30" cy="30" r="3" fill="currentColor" opacity="0.5" stroke="none"/>
                         <path d="M 30 30 Q 45 15 60 30" fill="none" strokeWidth="2" />
                         <circle cx="60" cy="30" r="4" fill="currentColor" stroke="none"/>
                         <line x1="60" y1="30" x2="60" y2="50" strokeWidth="1" strokeDasharray="2 2" opacity="0.5"/>
                    </>
                )}
            </svg>
        );

        /* --- Content Data --- */
        const solutionData = [
            {
                section: "A",
                title: "Past Simple or Past Progressive?",
                desc: "Выбор между фактом/последовательностью и процессом.",
                sentences: [
                    "I tried to phone you yesterday afternoon. - Sorry, Greg. I <b>wasn't</b> at home. I <b>was helping</b> Chris to prepare a survey on school life in the UK.",
                    "When John arrived, we <b>were having</b> breakfast.",
                    { text: "- Why didn't you do your homework yesterday? - I <b>was visiting</b> my grandma in hospital.", note: "Здесь также допустимо visited, но was visiting подчеркивает процесс, который занял время." },
                    "What <b>was happening</b> in this room when you walked in today?",
                    "What <b>did you do</b> last weekend?",
                    "While I <b>was surfing</b> the net yesterday, I found a really interesting website.",
                    "No one could see the puppy because it <b>was hiding</b> in the rose bushes.",
                    "I didn't hear the thunder during the storm last night because I <b>was sleeping</b>.",
                    "Jack <b>was walking</b> down the street when it began to rain.",
                    "At eight o'clock last night my little brother <b>was sleeping</b> happily.",
                    "While Mrs Evans <b>was telling</b> her grandson a fairy tale, the little boy fell asleep, so she closed the book and quietly left the room.",
                    "What <b>was Lizzy wearing</b> at the party last night?",
                    "My cousins <b>were quarrelling</b> about something when I came into the room.",
                    "It was early morning. The sea <b>was sparkling</b> under the rays of the sun. The birds <b>were singing</b> their beautiful songs."
                ]
            },
            {
                section: "B",
                title: "Past Simple or Present Perfect?",
                desc: "Выбор между действием в прошлом (время указано) и результатом.",
                sentences: [
                    { text: "Alex looks sad. He <b>must have heard</b> some bad news.", note: "Перфектный инфинитив после must для предположения о прошлом." },
                    "Richard and Paul <b>haven't attended</b> any parties since they came back home.",
                    "Jane caught a bad cold last weekend. She <b>has been</b> ill several times this term.",
                    "Pat <b>has played</b> a lot of tennis in the last two months.",
                    "This is the first time Miss Ross <b>has arrived</b> in Germany.",
                    "Alex is an artist. He <b>has drawn</b> three beautiful landscapes recently. Last week he <b>drew</b> a small seascape.",
                    "<b>Have you bought</b> the dictionary I told you about? Yes. When <b>did you buy</b> it?",
                    "So far Jill <b>has sewn</b> three nice blouses.",
                    "I <b>have known</b> Archy all my life. I <b>got acquainted</b> with him when we were four.",
                    { text: "Paul Newman says he saw snow for the first time last February. He says he <b>never saw</b> snow before.", note: "Строго говоря, здесь требуется Past Perfect (had never seen), но в рамках задания Simple/Perfect допустим Simple." },
                    "Bruce <b>has worn</b> his new fashionable tie only once since he bought it. He <b>wore</b> it to our party last Saturday night.",
                    "Kathy <b>has just phoned</b>. She wants you to phone her back.",
                    "The 2004 Olympics <b>were</b> in Athens, Greece.",
                    "The information technology revolution <b>has transformed</b> our lives in many ways, making it easier to communicate with each other."
                ]
            },
            {
                section: "C",
                title: "Present Perfect or Present Perfect Progressive?",
                desc: "Результат (Perfect) vs Длительное действие (Progressive).",
                sentences: [
                    "I <b>have had</b> this bike for ages, it's literally falling apart.",
                    "I wonder what you <b>have been doing</b> in my room. Sorry, I <b>have been looking</b> for some old photographs.",
                    "Sit down and catch your breath. <b>Have you been running</b>?",
                    "Anna is an old friend of mine. I <b>have known</b> her nearly all my life.",
                    "Why are you angry? What <b>have I done</b>?",
                    "The Barkers <b>have been renting</b> this house since they moved to Liverpool.",
                    "The Greens <b>have owned</b> this plot of land for centuries. You might say it <b>has always been</b> theirs.",
                    "I <b>have been calling</b> you all the evening. Where <b>have you been</b>?",
                    "Mark <b>has been staying</b> with us for a couple of weeks, but he is planning to leave tomorrow morning.",
                    "Look, this player <b>has broken</b> the rules again. He <b>has been playing</b> very badly in this match.",
                    "<b>Has the taxi arrived</b> yet? We <b>have been waiting</b> too long.",
                    { text: "We <b>have been working</b> without a break since 9 o'clock in the morning. I'm sure everyone <b>has got</b> tired.", note: "В британском английском get в значении 'стать' в Present Perfect — has got." },
                    "Your eyes look red and swollen. <b>Have you been crying</b>?",
                    { text: "I'm afraid I <b>have heard</b> this story five times since yesterday and I don't want to hear it again.", note: "Указание количества раз 'five times' требует Present Perfect." }
                ]
            }
        ];

        /* --- Components --- */
        const RuleCard = ({ title, content, description, VisualComp, delay, isLarge = false }) => (
            <div className={`
                relative overflow-hidden
                bg-light-surfaceContainerHigh/50 dark:bg-dark-surfaceContainerHigh/30 
                rounded-[28px] border border-black/5 dark:border-white/5 
                animate-enter transition-all duration-300
                flex flex-col
                ${isLarge ? 'p-6 col-span-2' : 'p-5 col-span-1'}
            `} style={{animationDelay: `${delay}ms`}}>
                <div className="flex justify-between items-start mb-4 relative z-10">
                    <span className="text-[10px] font-bold text-light-primary dark:text-dark-primary uppercase tracking-widest bg-light-primary/10 dark:bg-dark-primary/10 px-2 py-1 rounded-md">
                        {title}
                    </span>
                </div>
                <div className="flex items-center justify-between gap-2 relative z-10 h-full">
                    <div className="flex flex-col gap-1">
                        <div className={`eng-font font-medium text-light-onSecondaryContainer dark:text-dark-onSecondaryContainer leading-tight ${isLarge ? 'text-xl' : 'text-base'}`}>
                            {content}
                        </div>
                        {description && (
                            <div className="text-xs leading-relaxed opacity-60 font-medium mt-1">
                                {description}
                            </div>
                        )}
                    </div>
                    {VisualComp && <div className="scale-90 opacity-80 shrink-0"><VisualComp /></div>}
                </div>
                <div className="absolute -right-4 -bottom-4 w-24 h-24 rounded-full bg-light-primary/5 dark:bg-dark-primary/5 pointer-events-none"></div>
            </div>
        );

        const SolutionSection = ({ data, delay }) => (
            <div className="animate-enter mb-6" style={{animationDelay: `${delay}ms`}}>
                <div className="flex items-baseline gap-3 mb-3 px-2">
                     <span className="text-xl font-bold text-light-primary dark:text-dark-primary">{data.section}</span>
                     <div>
                        <h2 className="text-sm font-bold opacity-80 uppercase tracking-wider">{data.title}</h2>
                        <p className="text-[10px] opacity-50">{data.desc}</p>
                     </div>
                </div>
                <div className="bg-light-surfaceContainerHigh/30 dark:bg-dark-surfaceContainerHigh/20 rounded-[24px] p-1 border border-black/5 dark:border-white/5">
                    {data.sentences.map((item, idx) => {
                        const content = typeof item === 'string' ? item : item.text;
                        const note = typeof item === 'object' ? item.note : null;
                        
                        return (
                            <div key={idx} className="relative group p-3 rounded-[20px] hover:bg-light-surface/60 dark:hover:bg-white/5 transition-colors duration-200">
                                <div className="flex gap-3">
                                    <span className="text-xs font-mono opacity-40 mt-1 w-5 text-right shrink-0">{idx + 1}.</span>
                                    <div className="flex-1">
                                        <p 
                                            className="eng-font text-sm leading-relaxed text-light-onSecondaryContainer dark:text-dark-onSecondaryContainer"
                                            dangerouslySetInnerHTML={{ 
                                                __html: content.replace(/<b>/g, '<span class="font-bold text-light-primary dark:text-dark-primary bg-light-primary/10 dark:bg-dark-primary/10 px-1 rounded mx-0.5">').replace(/<\/b>/g, '</span>') 
                                            }} 
                                        />
                                        {note && (
                                            <div className="mt-2 flex gap-2 items-start">
                                                <Icon name="info" className="text-[14px] opacity-50 mt-0.5" />
                                                <p className="text-[11px] opacity-60 leading-tight italic">{note}</p>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        );
                    })}
                </div>
            </div>
        );

        /* --- Main Application --- */
        const App = () => {
            const [tab, setTab] = useState('theory');

            // Init Theme
            useEffect(() => {
                const savedTheme = localStorage.getItem('theme') || 'dark';
                const savedHue = parseInt(localStorage.getItem('accentHue')) || 215; 
                const savedTertiaryHue = parseInt(localStorage.getItem('tertiaryHue')) || 280;
                
                document.documentElement.classList.toggle('dark', savedTheme === 'dark');
                updateThemeVariables(savedHue, savedTertiaryHue, savedTheme === 'dark');
            }, []);

            return (
                <div className="max-w-md mx-auto min-h-screen pb-20 relative flex flex-col font-sans">
                    
                    {/* Header */}
                    <header className="px-6 pt-8 pb-2 flex justify-between items-end animate-enter">
                        <div>
                            <p className="text-xs font-bold opacity-60 uppercase tracking-widest mb-1 text-light-primary dark:text-dark-primary">Упражнение 12</p>
                            <h1 className="text-3xl font-bold leading-tight">English <br/> <span className="opacity-50">Grammar</span></h1>
                        </div>
                        <div className="flex flex-col items-center gap-1">
                             <div className="w-12 h-12 rounded-full bg-light-surfaceContainerHigh dark:bg-dark-surfaceContainerHigh flex items-center justify-center text-2xl font-bold shadow-sm text-light-primary dark:text-dark-primary relative overflow-hidden">
                                {tab === 'practice' ? (
                                    <span key="icon-key" className="animate-enter material-symbols-rounded text-xl">key</span>
                                ) : (
                                    <span key="icon-book" className="animate-enter text-xl">Aa</span>
                                )}
                            </div>
                        </div>
                    </header>

                    {/* Navigation */}
                    <nav className="px-4 mt-6 mb-4 animate-enter" style={{animationDelay: '100ms'}}>
                        <div className="bg-light-surfaceContainerHigh dark:bg-dark-surfaceContainerHigh p-1.5 rounded-2xl grid grid-cols-2 relative">
                            <button 
                                onClick={() => setTab('theory')}
                                className={`
                                    py-2.5 text-sm font-bold rounded-xl transition-all duration-300 flex items-center justify-center gap-2
                                    ${tab === 'theory' 
                                        ? 'bg-light-surface dark:bg-dark-surface shadow-md text-light-primary dark:text-dark-primary' 
                                        : 'opacity-60 hover:opacity-100'}
                                `}
                            >
                                <Icon name="menu_book" className="text-lg" />
                                Теория
                            </button>
                            <button 
                                onClick={() => setTab('practice')}
                                className={`
                                    py-2.5 text-sm font-bold rounded-xl transition-all duration-300 flex items-center justify-center gap-2
                                    ${tab === 'practice' 
                                        ? 'bg-light-surface dark:bg-dark-surface shadow-md text-light-primary dark:text-dark-primary' 
                                        : 'opacity-60 hover:opacity-100'}
                                `}
                            >
                                <Icon name="assignment_turned_in" className="text-lg" />
                                Решение
                            </button>
                        </div>
                    </nav>

                    <main className="px-4 flex-1">
                        {tab === 'theory' ? (
                            <div className="space-y-4 pb-8">
                                <div className="grid grid-cols-2 gap-3">
                                    <RuleCard 
                                        title="Section A" 
                                        content="Simple vs Continuous"
                                        description="Факт против Процесса"
                                        VisualComp={() => <TimelineVisual type="continuous"/>}
                                        delay={150}
                                    />
                                    <RuleCard 
                                        title="Section B" 
                                        content="Simple vs Perfect"
                                        description="Время указано vs Результат"
                                        VisualComp={() => <Icon name="event" className="text-4xl opacity-80 text-light-primary dark:text-dark-primary" />}
                                        delay={200}
                                    />
                                </div>
                                
                                <RuleCard 
                                    title="Ключевое правило" 
                                    content="Stative Verbs (Глаголы состояния)"
                                    description={<>Глаголы <i>know, have, be, own</i> не употребляются в Progressive, даже если действие длительное.</>}
                                    VisualComp={() => <Icon name="psychology_alt" className="text-5xl opacity-80 text-light-primary dark:text-dark-primary" />}
                                    delay={250}
                                    isLarge
                                />
                                
                                <div className="grid grid-cols-2 gap-3">
                                    <RuleCard 
                                        title="Section C" 
                                        content="Perf. Continuous"
                                        description="Действие началось и длится"
                                        VisualComp={() => <TimelineVisual type="perfect"/>}
                                        delay={350}
                                        isLarge
                                    />
                                </div>
                            </div>
                        ) : (
                            <div className="pb-10 pt-2">
                                {solutionData.map((section, idx) => (
                                    <SolutionSection key={section.section} data={section} delay={150 + (idx * 100)} />
                                ))}
                            </div>
                        )}
                    </main>
                    
                    {tab === 'theory' && (
                        <footer className="text-center opacity-30 text-[10px] py-6 animate-enter" style={{animationDelay: '500ms'}}>
                            English Grammar • Exercise 12 (pp. 71-72)
                        </footer>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
